<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excel Import Guide - Azure Assessment Data</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background-color: white;
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        h1 {
            color: #0078d4;
            border-bottom: 3px solid #0078d4;
            padding-bottom: 15px;
        }
        h2 {
            color: #106ebe;
            margin-top: 35px;
            border-left: 5px solid #0078d4;
            padding-left: 15px;
        }
        h3 {
            color: #2b88d8;
            margin-top: 25px;
        }
        .info {
            background-color: #e7f3ff;
            border-left: 4px solid #0078d4;
            padding: 15px;
            margin: 20px 0;
        }
        .info-title {
            font-weight: bold;
            color: #004578;
            margin-bottom: 5px;
        }
        .warning {
            background-color: #fff4ce;
            border-left: 4px solid #ffb900;
            padding: 15px;
            margin: 20px 0;
        }
        .warning-title {
            font-weight: bold;
            color: #8a6d00;
            margin-bottom: 5px;
        }
        .tip {
            background-color: #dff6dd;
            border-left: 4px solid #107c10;
            padding: 15px;
            margin: 20px 0;
        }
        .tip-title {
            font-weight: bold;
            color: #0b5a0b;
            margin-bottom: 5px;
        }
        .step {
            background-color: #f9f9f9;
            border: 1px solid #e0e0e0;
            border-radius: 5px;
            padding: 20px;
            margin: 15px 0;
        }
        .step-number {
            display: inline-block;
            background-color: #0078d4;
            color: white;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            text-align: center;
            line-height: 35px;
            font-weight: bold;
            font-size: 1.2em;
            margin-right: 15px;
        }
        code {
            background-color: #2d2d2d;
            color: #d4d4d4;
            padding: 3px 8px;
            border-radius: 3px;
            font-family: 'Consolas', 'Courier New', monospace;
            font-size: 0.95em;
        }
        .code-block {
            background-color: #2d2d2d;
            color: #d4d4d4;
            padding: 15px;
            border-radius: 5px;
            font-family: 'Consolas', 'Courier New', monospace;
            overflow-x: auto;
            margin: 15px 0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #0078d4;
            color: white;
        }
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        ul, ol {
            margin-left: 20px;
        }
        li {
            margin: 8px 0;
        }
        .mapping-table th:first-child {
            width: 35%;
        }
        .mapping-table th:nth-child(2) {
            width: 35%;
        }
        .mapping-table th:nth-child(3) {
            width: 30%;
        }
        kbd {
            background-color: #f0f0f0;
            border: 1px solid #ccc;
            border-radius: 3px;
            padding: 2px 6px;
            font-family: 'Consolas', monospace;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìä Excel Import Guide</h1>
        <p class="subtitle" style="color: #666; font-size: 1.1em;">Importing Azure Assessment CSV Data into Azure_Framework_2025.xlsx</p>
        <p style="color: #999; font-style: italic;">Last Updated: October 16, 2025</p>

        <!-- OVERVIEW -->
        <h2>üìã Overview</h2>
        
        <p>This guide provides step-by-step instructions for importing the 15 CSV files generated from the Azure security assessment into the <strong>Azure_Framework_2025.xlsx</strong> spreadsheet.</p>

        <div class="info">
            <div class="info-title">üìÅ CSV File Location</div>
            <p>All CSV files are located in:<br>
            <code>C:\CustomerEnv-Workspace\Azure_Assessment_Kit\transformed\</code></p>
            <p><strong>Total:</strong> 15 CSV files (~12 MB)</p>
        </div>

        <!-- IMPORT METHODS -->
        <h2>üîß Import Methods</h2>

        <p>You have three options for importing data:</p>

        <table>
            <thead>
                <tr>
                    <th>Method</th>
                    <th>Best For</th>
                    <th>Pros</th>
                    <th>Cons</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>Power Query</strong> (Recommended)</td>
                    <td>Automated updates</td>
                    <td>Refreshable, automatic formatting, handles large files</td>
                    <td>Requires Excel 2016+</td>
                </tr>
                <tr>
                    <td><strong>Manual Import</strong></td>
                    <td>Small datasets</td>
                    <td>Simple, no setup needed</td>
                    <td>Manual process, not refreshable</td>
                </tr>
                <tr>
                    <td><strong>VBA Macro</strong></td>
                    <td>Automation</td>
                    <td>One-click import</td>
                    <td>Requires macro permissions</td>
                </tr>
            </tbody>
        </table>

        <!-- CSV TO SHEET MAPPING -->
        <h2>üó∫Ô∏è CSV to Sheet Mapping</h2>

        <p>Map each CSV file to the corresponding sheet in Azure_Framework_2025.xlsx:</p>

        <table class="mapping-table">
            <thead>
                <tr>
                    <th>CSV File</th>
                    <th>Excel Sheet Name</th>
                    <th>Row Count</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>secure_scores.csv</code></td>
                    <td>Secure Scores / Security Dashboard</td>
                    <td>34</td>
                </tr>
                <tr>
                    <td><code>security_assessments.csv</code></td>
                    <td>Security Findings / Assessments</td>
                    <td>18,142</td>
                </tr>
                <tr>
                    <td><code>resources.csv</code></td>
                    <td>Resource Inventory</td>
                    <td>5,088</td>
                </tr>
                <tr>
                    <td><code>resource_groups.csv</code></td>
                    <td>Resource Groups</td>
                    <td>856</td>
                </tr>
                <tr>
                    <td><code>role_assignments.csv</code></td>
                    <td>Identity & Access / RBAC</td>
                    <td>6,269</td>
                </tr>
                <tr>
                    <td><code>virtual_networks.csv</code></td>
                    <td>Network Security / VNets</td>
                    <td>105</td>
                </tr>
                <tr>
                    <td><code>network_security_groups.csv</code></td>
                    <td>Network Security / NSGs</td>
                    <td>662</td>
                </tr>
                <tr>
                    <td><code>private_endpoints.csv</code></td>
                    <td>Network Security / Private Endpoints</td>
                    <td>84</td>
                </tr>
                <tr>
                    <td><code>storage_accounts.csv</code></td>
                    <td>Data Protection / Storage</td>
                    <td>290</td>
                </tr>
                <tr>
                    <td><code>key_vaults.csv</code></td>
                    <td>Data Protection / Key Vaults</td>
                    <td>234</td>
                </tr>
                <tr>
                    <td><code>sql_servers.csv</code></td>
                    <td>Data Protection / SQL Servers</td>
                    <td>26</td>
                </tr>
                <tr>
                    <td><code>sql_databases.csv</code></td>
                    <td>Data Protection / SQL Databases</td>
                    <td>50</td>
                </tr>
                <tr>
                    <td><code>log_analytics_workspaces.csv</code></td>
                    <td>Logging & Monitoring / Workspaces</td>
                    <td>68</td>
                </tr>
                <tr>
                    <td><code>diagnostic_settings.csv</code></td>
                    <td>Logging & Monitoring / Diagnostics</td>
                    <td>63</td>
                </tr>
                <tr>
                    <td><code>policy_assignments.csv</code></td>
                    <td>Governance / Policies</td>
                    <td>436</td>
                </tr>
            </tbody>
        </table>

        <!-- METHOD 1: POWER QUERY -->
        <h2>‚ö° Method 1: Power Query Import (Recommended)</h2>

        <div class="tip">
            <div class="tip-title">üí° Why Power Query?</div>
            <p>Power Query allows you to refresh data with one click when CSV files are updated. It's the best method for large datasets and provides automatic data type detection and formatting.</p>
        </div>

        <h3>Step-by-Step: Power Query Import</h3>

        <div class="step">
            <p><span class="step-number">1</span><strong>Open Azure_Framework_2025.xlsx</strong></p>
            <ol>
                <li>Navigate to the workbook location</li>
                <li>Open <code>Azure_Framework_2025.xlsx</code> in Excel</li>
                <li>Make sure you have Excel 2016 or later</li>
            </ol>
        </div>

        <div class="step">
            <p><span class="step-number">2</span><strong>Navigate to Target Sheet</strong></p>
            <ol>
                <li>Click on the sheet where you want to import data (e.g., "Security Findings")</li>
                <li>Select cell <strong>A1</strong> (or where you want data to start)</li>
                <li>Clear any existing data if needed</li>
            </ol>
        </div>

        <div class="step">
            <p><span class="step-number">3</span><strong>Import CSV using Power Query</strong></p>
            <ol>
                <li>Click the <strong>Data</strong> tab in Excel ribbon</li>
                <li>Click <strong>Get Data</strong> ‚Üí <strong>From File</strong> ‚Üí <strong>From Text/CSV</strong></li>
                <li>Navigate to: <code>C:\CustomerEnv-Workspace\Azure_Assessment_Kit\transformed\</code></li>
                <li>Select the appropriate CSV file (see mapping table above)</li>
                <li>Click <strong>Import</strong></li>
            </ol>
        </div>

        <div class="step">
            <p><span class="step-number">4</span><strong>Preview and Transform Data</strong></p>
            <ol>
                <li>Excel will show a preview of the data</li>
                <li>Verify columns are correctly detected</li>
                <li>If data looks good, click <strong>Load</strong></li>
                <li>If adjustments needed, click <strong>Transform Data</strong> to open Power Query Editor</li>
            </ol>
        </div>

        <div class="step">
            <p><span class="step-number">5</span><strong>Data Loads to Sheet</strong></p>
            <ol>
                <li>Data will automatically populate the sheet</li>
                <li>Excel will create a Table with filter headers</li>
                <li>Column widths may need adjustment</li>
            </ol>
        </div>

        <div class="step">
            <p><span class="step-number">6</span><strong>Format the Table (Optional)</strong></p>
            <ol>
                <li>Right-click the table</li>
                <li>Select <strong>Table</strong> ‚Üí <strong>Table Style Options</strong></li>
                <li>Choose desired formatting</li>
                <li>Adjust column widths: Select all columns, double-click column border to auto-fit</li>
            </ol>
        </div>

        <div class="step">
            <p><span class="step-number">7</span><strong>Repeat for Each CSV File</strong></p>
            <p>Go through steps 2-6 for each of the 15 CSV files, importing them into their respective sheets.</p>
        </div>

        <div class="tip">
            <div class="tip-title">üîÑ Refreshing Data</div>
            <p>After initial import, you can refresh all data at once:</p>
            <ol>
                <li>Click <strong>Data</strong> tab</li>
                <li>Click <strong>Refresh All</strong></li>
                <li>All Power Query tables will update from the CSV files</li>
            </ol>
        </div>

        <!-- METHOD 2: MANUAL IMPORT -->
        <h2>üìù Method 2: Manual Import</h2>

        <div class="warning">
            <div class="warning-title">‚ö†Ô∏è Note</div>
            <p>Manual import is simpler but data cannot be refreshed automatically. Use this method only for small files or one-time imports.</p>
        </div>

        <h3>Step-by-Step: Manual Import</h3>

        <div class="step">
            <p><span class="step-number">1</span><strong>Open CSV File</strong></p>
            <ol>
                <li>Right-click the CSV file in File Explorer</li>
                <li>Select <strong>Open with</strong> ‚Üí <strong>Excel</strong></li>
                <li>CSV data opens in Excel</li>
            </ol>
        </div>

        <div class="step">
            <p><span class="step-number">2</span><strong>Select All Data</strong></p>
            <ol>
                <li>Press <kbd>Ctrl</kbd> + <kbd>A</kbd> to select all</li>
                <li>Or click the triangle in top-left corner of the sheet</li>
                <li>Press <kbd>Ctrl</kbd> + <kbd>C</kbd> to copy</li>
            </ol>
        </div>

        <div class="step">
            <p><span class="step-number">3</span><strong>Paste into Target Sheet</strong></p>
            <ol>
                <li>Switch to <code>Azure_Framework_2025.xlsx</code></li>
                <li>Navigate to the appropriate sheet</li>
                <li>Click cell <strong>A1</strong></li>
                <li>Press <kbd>Ctrl</kbd> + <kbd>V</kbd> to paste</li>
            </ol>
        </div>

        <div class="step">
            <p><span class="step-number">4</span><strong>Format as Table</strong></p>
            <ol>
                <li>Select any cell in the pasted data</li>
                <li>Press <kbd>Ctrl</kbd> + <kbd>T</kbd> (or click Insert ‚Üí Table)</li>
                <li>Check "My table has headers"</li>
                <li>Click <strong>OK</strong></li>
            </ol>
        </div>

        <!-- DETAILED IMPORT INSTRUCTIONS PER CATEGORY -->
        <h2>üìë Detailed Import Instructions by Category</h2>

        <!-- SECURITY DATA -->
        <h3>1. Security Data</h3>

        <h4>A. Secure Scores</h4>
        <div class="step">
            <p><strong>File:</strong> <code>secure_scores.csv</code> (34 rows)</p>
            <p><strong>Target Sheet:</strong> Create new sheet named "Secure Scores" or import to existing "Security Dashboard"</p>
            <p><strong>Columns:</strong></p>
            <ul>
                <li>Subscription ID</li>
                <li>Score Name</li>
                <li>Current Score</li>
                <li>Max Score</li>
                <li>Percentage</li>
                <li>Resource ID</li>
            </ul>
            <p><strong>Recommended Visualizations:</strong></p>
            <ul>
                <li>Bar chart: Secure Score % by Subscription</li>
                <li>Gauge chart: Average Secure Score</li>
                <li>Conditional formatting: Red (&lt;40%), Yellow (40-70%), Green (&gt;70%)</li>
            </ul>
        </div>

        <h4>B. Security Assessments</h4>
        <div class="step">
            <p><strong>File:</strong> <code>security_assessments.csv</code> (18,142 rows)</p>
            <p><strong>Target Sheet:</strong> Create "Security Findings" or "Security Assessments"</p>
            <p><strong>Important:</strong> This is a large file (4.9 MB). Excel may take a moment to load.</p>
            <p><strong>Recommended Filters:</strong></p>
            <ul>
                <li>Filter by Status = "Unhealthy" to see action items (1,931 rows)</li>
                <li>Create pivot table to summarize by subscription</li>
                <li>Group by Assessment Name to see common issues</li>
            </ul>
        </div>

        <div class="warning">
            <div class="warning-title">‚ö†Ô∏è Large File Warning</div>
            <p>The <code>security_assessments.csv</code> file has 18,142 rows. Excel can handle this, but:</p>
            <ul>
                <li>Import may take 30-60 seconds</li>
                <li>Consider filtering to "Unhealthy" only for analysis</li>
                <li>Use pivot tables instead of working with raw data</li>
            </ul>
        </div>

        <!-- INVENTORY DATA -->
        <h3>2. Inventory Data</h3>

        <h4>A. Resources</h4>
        <div class="step">
            <p><strong>File:</strong> <code>resources.csv</code> (5,088 rows)</p>
            <p><strong>Target Sheet:</strong> "Resource Inventory" or "All Resources"</p>
            <p><strong>Recommended Analysis:</strong></p>
            <ul>
                <li>Pivot table: Count by Resource Type</li>
                <li>Pivot table: Resources by Subscription</li>
                <li>Pivot table: Resources by Location</li>
                <li>Filter by specific types (e.g., all VMs, all storage accounts)</li>
            </ul>
        </div>

        <h4>B. Resource Groups</h4>
        <div class="step">
            <p><strong>File:</strong> <code>resource_groups.csv</code> (856 rows)</p>
            <p><strong>Target Sheet:</strong> "Resource Groups"</p>
            <p><strong>Use Cases:</strong></p>
            <ul>
                <li>View all resource groups by subscription</li>
                <li>Analyze naming conventions</li>
                <li>Check provisioning states</li>
                <li>Review tagging compliance</li>
            </ul>
        </div>

        <!-- RBAC DATA -->
        <h3>3. Identity & Access Data</h3>

        <h4>A. Role Assignments</h4>
        <div class="step">
            <p><strong>File:</strong> <code>role_assignments.csv</code> (6,269 rows)</p>
            <p><strong>Target Sheet:</strong> "RBAC" or "Identity & Access"</p>
            <p><strong>Critical Analysis:</strong></p>
            <ul>
                <li><strong>Filter for privileged roles:</strong> Owner, Contributor, User Access Administrator</li>
                <li><strong>Review by Principal Type:</strong> Identify direct user assignments</li>
                <li><strong>Scope analysis:</strong> Find subscription-level assignments</li>
                <li><strong>Create pivot table:</strong> Principals with multiple high-privilege assignments</li>
            </ul>
        </div>

        <div class="tip">
            <div class="tip-title">üîç RBAC Analysis Tips</div>
            <p>Create these filtered views for security review:</p>
            <ul>
                <li><strong>All Owners:</strong> Filter "Role Name" = "Owner" (315 rows)</li>
                <li><strong>User Assignments:</strong> Filter "Principal Type" = "User" (275 rows)</li>
                <li><strong>Subscription-level Access:</strong> Filter "Scope Level" = "Subscription" (1,526 rows)</li>
            </ul>
        </div>

        <!-- NETWORK DATA -->
        <h3>4. Network Security Data</h3>

        <h4>A. Virtual Networks</h4>
        <div class="step">
            <p><strong>File:</strong> <code>virtual_networks.csv</code> (105 rows)</p>
            <p><strong>Target Sheet:</strong> "Network Security" (VNets section)</p>
            <p><strong>Key Fields:</strong> VNet Name, Address Prefixes, Subnet Count, Location</p>
        </div>

        <h4>B. Network Security Groups</h4>
        <div class="step">
            <p><strong>File:</strong> <code>network_security_groups.csv</code> (662 rows)</p>
            <p><strong>Target Sheet:</strong> "Network Security" (NSGs section)</p>
            <p><strong>Analysis:</strong> Review custom rule counts, identify NSGs with many rules (potential complexity)</p>
        </div>

        <h4>C. Private Endpoints</h4>
        <div class="step">
            <p><strong>File:</strong> <code>private_endpoints.csv</code> (84 rows)</p>
            <p><strong>Target Sheet:</strong> "Network Security" (Private Connectivity section)</p>
        </div>

        <!-- DATA PROTECTION -->
        <h3>5. Data Protection Data</h3>

        <h4>A. Storage Accounts</h4>
        <div class="step">
            <p><strong>File:</strong> <code>storage_accounts.csv</code> (290 rows)</p>
            <p><strong>Target Sheet:</strong> "Data Protection" (Storage section)</p>
            <p><strong>Key Security Fields:</strong></p>
            <ul>
                <li>HTTPS Only (should be "Yes")</li>
                <li>Allow Public Blob Access (should be "False" or "No")</li>
                <li>Encryption Key Source</li>
            </ul>
        </div>

        <h4>B. Key Vaults</h4>
        <div class="step">
            <p><strong>File:</strong> <code>key_vaults.csv</code> (234 rows)</p>
            <p><strong>Target Sheet:</strong> "Data Protection" (Key Vaults section)</p>
            <p><strong>Critical Review Fields:</strong></p>
            <ul>
                <li>Soft Delete (üî¥ Currently all "No")</li>
                <li>Purge Protection (üî¥ Currently all "No")</li>
                <li>Public Network Access</li>
            </ul>
        </div>

        <h4>C. SQL Servers & Databases</h4>
        <div class="step">
            <p><strong>Files:</strong> <code>sql_servers.csv</code> (26 rows) + <code>sql_databases.csv</code> (50 rows)</p>
            <p><strong>Target Sheet:</strong> "Data Protection" (SQL section)</p>
            <p><strong>Key Fields:</strong></p>
            <ul>
                <li><strong>SQL Servers:</strong> Public Network Access (‚ö†Ô∏è 25 of 26 = "Enabled"), Minimal TLS Version</li>
                <li><strong>SQL Databases:</strong> SKU Tier, Max Size (GB), Status</li>
            </ul>
        </div>

        <!-- LOGGING DATA -->
        <h3>6. Logging & Monitoring Data</h3>

        <h4>A. Log Analytics Workspaces</h4>
        <div class="step">
            <p><strong>File:</strong> <code>log_analytics_workspaces.csv</code> (68 rows)</p>
            <p><strong>Target Sheet:</strong> "Logging & Monitoring"</p>
            <p><strong>Analysis:</strong> Review retention days, locations, coverage by subscription</p>
        </div>

        <h4>B. Diagnostic Settings</h4>
        <div class="step">
            <p><strong>File:</strong> <code>diagnostic_settings.csv</code> (63 rows)</p>
            <p><strong>Target Sheet:</strong> "Logging & Monitoring" (Diagnostics section)</p>
            <p><strong>Coverage Check:</strong> 25 of 34 subscriptions have diagnostic settings (74%)</p>
        </div>

        <!-- GOVERNANCE DATA -->
        <h3>7. Governance & Compliance Data</h3>

        <h4>A. Policy Assignments</h4>
        <div class="step">
            <p><strong>File:</strong> <code>policy_assignments.csv</code> (436 rows)</p>
            <p><strong>Target Sheet:</strong> "Governance" or "Policies"</p>
            <p><strong>Analysis:</strong> Review policy coverage, enforcement modes, scope levels</p>
        </div>

        <!-- POWER QUERY ADVANCED -->
        <h2>üöÄ Power Query Advanced: Refresh All Data</h2>

        <h3>Create a Master Refresh Button</h3>

        <p>After importing all CSV files via Power Query, you can refresh all data sources at once:</p>

        <div class="step">
            <p><span class="step-number">1</span><strong>View All Connections</strong></p>
            <ol>
                <li>Click <strong>Data</strong> tab</li>
                <li>Click <strong>Queries & Connections</strong></li>
                <li>Panel shows all imported queries</li>
            </ol>
        </div>

        <div class="step">
            <p><span class="step-number">2</span><strong>Refresh All</strong></p>
            <ol>
                <li>Click <strong>Data</strong> tab</li>
                <li>Click <strong>Refresh All</strong> (or press <kbd>Ctrl</kbd> + <kbd>Alt</kbd> + <kbd>F5</kbd>)</li>
                <li>All tables update from CSV files automatically</li>
            </ol>
        </div>

        <div class="tip">
            <div class="tip-title">üí° Pro Tip: Background Refresh</div>
            <p>Enable background refresh for large files:</p>
            <ol>
                <li>Right-click a query in the Queries & Connections panel</li>
                <li>Select <strong>Properties</strong></li>
                <li>Check <strong>Enable background refresh</strong></li>
                <li>Excel won't freeze while loading large datasets</li>
            </ol>
        </div>

        <!-- TROUBLESHOOTING -->
        <h2>üÜò Troubleshooting</h2>

        <h3>Issue: "File Not Found" Error</h3>
        <div class="step">
            <p><strong>Problem:</strong> Power Query can't find the CSV file</p>
            <p><strong>Solution:</strong></p>
            <ol>
                <li>Verify CSV files are in: <code>C:\CustomerEnv-Workspace\Azure_Assessment_Kit\transformed\</code></li>
                <li>Check file names match exactly (case-sensitive)</li>
                <li>Re-run transformation scripts if files missing</li>
            </ol>
        </div>

        <h3>Issue: Data Formatting Incorrect</h3>
        <div class="step">
            <p><strong>Problem:</strong> Columns show as text instead of numbers, dates incorrectly formatted</p>
            <p><strong>Solution:</strong></p>
            <ol>
                <li>Click <strong>Data</strong> ‚Üí <strong>Get Data</strong> ‚Üí <strong>Launch Power Query Editor</strong></li>
                <li>Right-click column header ‚Üí <strong>Change Type</strong></li>
                <li>Select appropriate data type (Number, Date, Text)</li>
                <li>Click <strong>Close & Load</strong></li>
            </ol>
        </div>

        <h3>Issue: Excel Freezes with Large Files</h3>
        <div class="step">
            <p><strong>Problem:</strong> Excel becomes unresponsive when importing large CSV files</p>
            <p><strong>Solution:</strong></p>
            <ol>
                <li>Close other applications to free up memory</li>
                <li>Enable background refresh (see Power Query Advanced section)</li>
                <li>For <code>security_assessments.csv</code>, consider filtering in Power Query before loading</li>
                <li>Use 64-bit Excel for better performance with large datasets</li>
            </ol>
        </div>

        <h3>Issue: Data Doesn't Refresh</h3>
        <div class="step">
            <p><strong>Problem:</strong> Clicking "Refresh All" doesn't update data</p>
            <p><strong>Solution:</strong></p>
            <ol>
                <li>Check if CSV files have been updated in the <code>transformed/</code> folder</li>
                <li>Verify file paths haven't changed</li>
                <li>Right-click query ‚Üí <strong>Properties</strong> ‚Üí Check <strong>Refresh control</strong> settings</li>
                <li>Try <strong>Refresh</strong> on individual query instead of "Refresh All"</li>
            </ol>
        </div>

        <h3>Issue: UTF-8 Characters Display Incorrectly</h3>
        <div class="step">
            <p><strong>Problem:</strong> Special characters or subscription names show as garbled text</p>
            <p><strong>Solution:</strong></p>
            <ol>
                <li>In Power Query Editor, click <strong>Data</strong> ‚Üí <strong>Get Data</strong></li>
                <li>When importing, ensure file origin is set to <strong>65001: Unicode (UTF-8)</strong></li>
                <li>If already imported, delete and re-import with correct encoding</li>
            </ol>
        </div>

        <!-- CREATING PIVOT TABLES -->
        <h2>üìä Creating Pivot Tables & Dashboards</h2>

        <h3>Recommended Pivot Tables</h3>

        <h4>1. Resources by Type and Subscription</h4>
        <div class="step">
            <p><strong>Source:</strong> resources.csv</p>
            <p><strong>Setup:</strong></p>
            <ul>
                <li><strong>Rows:</strong> Resource Type</li>
                <li><strong>Columns:</strong> Subscription ID</li>
                <li><strong>Values:</strong> Count of Resource ID</li>
            </ul>
            <p><strong>Use Case:</strong> See which resource types are deployed where</p>
        </div>

        <h4>2. Security Score Dashboard</h4>
        <div class="step">
            <p><strong>Source:</strong> secure_scores.csv</p>
            <p><strong>Setup:</strong></p>
            <ul>
                <li><strong>Rows:</strong> Subscription ID</li>
                <li><strong>Values:</strong> Average of Percentage</li>
                <li><strong>Chart:</strong> Horizontal bar chart, sorted by score</li>
            </ul>
            <p><strong>Use Case:</strong> Visual ranking of security posture by subscription</p>
        </div>

        <h4>3. Unhealthy Findings by Subscription</h4>
        <div class="step">
            <p><strong>Source:</strong> security_assessments.csv</p>
            <p><strong>Setup:</strong></p>
            <ul>
                <li><strong>Filter:</strong> Status = "Unhealthy"</li>
                <li><strong>Rows:</strong> Subscription ID</li>
                <li><strong>Values:</strong> Count of Assessment ID</li>
                <li><strong>Chart:</strong> Column chart</li>
            </ul>
            <p><strong>Use Case:</strong> Identify subscriptions needing most attention</p>
        </div>

        <h4>4. Privileged Access Report</h4>
        <div class="step">
            <p><strong>Source:</strong> role_assignments.csv</p>
            <p><strong>Setup:</strong></p>
            <ul>
                <li><strong>Filter:</strong> Role Name = "Owner" OR "Contributor" OR "User Access Administrator"</li>
                <li><strong>Rows:</strong> Principal Name</li>
                <li><strong>Columns:</strong> Role Name</li>
                <li><strong>Values:</strong> Count of Assignment ID</li>
            </ul>
            <p><strong>Use Case:</strong> Audit privileged access by individual</p>
        </div>

        <h4>5. Network Security Coverage</h4>
        <div class="step">
            <p><strong>Source:</strong> network_security_groups.csv</p>
            <p><strong>Setup:</strong></p>
            <ul>
                <li><strong>Rows:</strong> Subscription ID</li>
                <li><strong>Values:</strong> Count of NSG Name, Sum of Custom Rules</li>
            </ul>
            <p><strong>Use Case:</strong> See network security rule distribution</p>
        </div>

        <!-- BEST PRACTICES -->
        <h2>‚ú® Best Practices</h2>

        <h3>Data Organization</h3>
        <ul>
            <li>‚úÖ <strong>Create separate sheets</strong> for each major category (Security, Inventory, RBAC, Network, etc.)</li>
            <li>‚úÖ <strong>Use Table format</strong> for all imported data (enables filtering and structured references)</li>
            <li>‚úÖ <strong>Create a Dashboard sheet</strong> with pivot charts from all sources</li>
            <li>‚úÖ <strong>Document update dates</strong> - Add cell showing when data was last refreshed</li>
            <li>‚úÖ <strong>Protect source sheets</strong> - Lock sheets with raw data to prevent accidental changes</li>
        </ul>

        <h3>Performance Optimization</h3>
        <ul>
            <li>‚úÖ <strong>Load large tables to Data Model</strong> instead of worksheet (Insert ‚Üí PivotTable ‚Üí Add to Data Model)</li>
            <li>‚úÖ <strong>Use slicers</strong> instead of manual filtering for interactive dashboards</li>
            <li>‚úÖ <strong>Refresh during off-hours</strong> for large datasets</li>
            <li>‚úÖ <strong>Save workbook after each import</strong> to avoid data loss</li>
        </ul>

        <h3>Data Analysis Tips</h3>
        <ul>
            <li>üìä <strong>Create a Summary sheet</strong> with key metrics and charts</li>
            <li>üé® <strong>Use conditional formatting</strong> for security scores, compliance percentages</li>
            <li>üìà <strong>Build trend charts</strong> if you re-run assessment monthly</li>
            <li>üîç <strong>Use Excel's Table filtering</strong> to drill into specific issues</li>
            <li>üìã <strong>Export filtered views</strong> as separate sheets for team review</li>
        </ul>

        <!-- SAMPLE FORMULAS -->
        <h2>üìê Sample Excel Formulas</h2>

        <h3>Count Subscriptions with Low Secure Score</h3>
        <div class="code-block"><pre>=COUNTIF([Percentage],"&lt;40")</pre></div>
        <p>Counts subscriptions with Secure Score below 40%</p>

        <h3>Calculate Total Unhealthy Findings</h3>
        <div class="code-block"><pre>=COUNTIF([Status],"Unhealthy")</pre></div>
        <p>Counts all security assessments marked as unhealthy</p>

        <h3>Find High-Privilege Users</h3>
        <div class="code-block"><pre>=COUNTIFS([Principal Type],"User",[Role Name],"Owner")</pre></div>
        <p>Counts direct user assignments with Owner role</p>

        <h3>Average Secure Score</h3>
        <div class="code-block"><pre>=AVERAGE([Percentage])</pre></div>
        <p>Calculates average Secure Score across all subscriptions</p>

        <!-- QUICK START -->
        <h2>‚ö° Quick Start: Import Top 5 Files</h2>

        <p>If you're short on time, start by importing these 5 most critical files:</p>

        <ol>
            <li><strong>secure_scores.csv</strong> ‚Üí Shows overall security posture</li>
            <li><strong>security_assessments.csv</strong> ‚Üí All Defender findings (filter to Unhealthy)</li>
            <li><strong>role_assignments.csv</strong> ‚Üí Identity security review</li>
            <li><strong>resources.csv</strong> ‚Üí Complete resource inventory</li>
            <li><strong>key_vaults.csv</strong> ‚Üí Critical: shows Key Vault protection gap</li>
        </ol>

        <p>These 5 files provide 90% of the insights needed for executive reporting.</p>

        <!-- AUTOMATION OPTION -->
        <h2>ü§ñ Optional: VBA Automation Script</h2>

        <div class="info">
            <div class="info-title">üìù VBA Import Macro</div>
            <p>For advanced users, a VBA macro can automate the entire import process. This would:</p>
            <ul>
                <li>Import all 15 CSV files with one button click</li>
                <li>Automatically map to correct sheets</li>
                <li>Apply formatting and create pivot tables</li>
            </ul>
            <p><strong>Contact the assessment team if you need the VBA macro script.</strong></p>
        </div>

        <!-- VALIDATION -->
        <h2>‚úÖ Data Validation Checklist</h2>

        <p>After importing, verify data integrity:</p>

        <table>
            <thead>
                <tr>
                    <th>Check</th>
                    <th>Expected Value</th>
                    <th>How to Verify</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Total Subscriptions</td>
                    <td>34</td>
                    <td>Count unique Subscription IDs in any table</td>
                </tr>
                <tr>
                    <td>Total Resources</td>
                    <td>5,088</td>
                    <td>Count rows in resources.csv import</td>
                </tr>
                <tr>
                    <td>Total Role Assignments</td>
                    <td>6,269</td>
                    <td>Count rows in role_assignments.csv import</td>
                </tr>
                <tr>
                    <td>Security Assessments</td>
                    <td>18,142</td>
                    <td>Count rows in security_assessments.csv import</td>
                </tr>
                <tr>
                    <td>Secure Scores</td>
                    <td>34</td>
                    <td>Count rows in secure_scores.csv import</td>
                </tr>
                <tr>
                    <td>Average Secure Score</td>
                    <td>~44.1%</td>
                    <td>Average of Percentage column</td>
                </tr>
            </tbody>
        </table>

        <!-- NEXT STEPS -->
        <h2>üìå After Import: Next Steps</h2>

        <ol>
            <li><strong>Create Dashboard Sheet:</strong> Build executive dashboard with key charts and metrics</li>
            <li><strong>Build Pivot Tables:</strong> Use recommendations above for analysis</li>
            <li><strong>Apply Conditional Formatting:</strong> Highlight critical issues (low scores, unhealthy status, privileged roles)</li>
            <li><strong>Generate Reports:</strong> Create filtered views for different audiences (Security, Management, Compliance)</li>
            <li><strong>Schedule Updates:</strong> Plan to re-run assessment quarterly and refresh Excel data</li>
        </ol>

        <!-- SUPPORT -->
        <h2>üìû Support & Resources</h2>

        <h3>Related Documentation</h3>
        <ul>
            <li><strong>EXECUTIVE_SUMMARY_REPORT.html</strong> - High-level findings and recommendations</li>
            <li><strong>CONTEXT_FOR_NEW_SESSION.md</strong> - Assessment project background</li>
            <li><strong>evidence_counts.csv</strong> - Complete file inventory</li>
            <li><strong>Scripts 11-17:</strong> Transformation scripts (if you need to re-run)</li>
        </ul>

        <h3>CSV File Locations</h3>
        <p><strong>Transformed Data:</strong><br>
        <code>C:\CustomerEnv-Workspace\Azure_Assessment_Kit\transformed\</code></p>
        
        <p><strong>Raw JSON Data:</strong><br>
        <code>C:\CustomerEnv-Workspace\Azure_Assessment_Kit\out\</code></p>

        <h3>Re-running Transformations</h3>
        <p>If you need to regenerate CSV files:</p>
        <div class="code-block"><pre># In PowerShell, navigate to scripts folder
cd C:\CustomerEnv-Workspace\Azure_Assessment_Kit\scripts

# Run transformation scripts
py .\11_transform_security.py
py .\12_transform_inventory.py
py .\13_transform_rbac.py
py .\14_transform_network.py
py .\15_transform_data_protection.py
py .\16_transform_logging.py
py .\17_transform_policies.py</pre></div>

        <!-- FOOTER -->
        <hr style="margin: 50px 0; border: none; border-top: 2px solid #e0e0e0;">
        
        <div style="text-align: center; color: #666; margin-top: 40px;">
            <p><strong>Azure Security Assessment Project</strong></p>
            <p>Excel Import Guide<br>
            Last Updated: October 16, 2025</p>
            <p style="margin-top: 20px; font-size: 0.9em;">
                Questions? Contact the Security Team
            </p>
        </div>
    </div>
</body>
</html>

